## 📆 2024-06-18

### 🔔 스크럼

- 학습 목표 1 : JWT 토큰

<br/>

### 🚀 Today I Learned

#### | JWT 토큰

`JWT`은 JSON Web Token을 말하며 자바스크립트의 Object 자료구조를 가지고 있음

JWT 사용 이유

- 서버 부하 감소  
  세션 기반 인증은 서버에 상태를 저장 -> 사용자가 많아질수록 서버에 부하가 걸림  
  JWT는 무상태 인증 방식으로 서버에 저장할 필요가 없어 서버 부하를 줄일 수 있음
- 확장성  
  JWT는 무상태이기 때문에 여러 서버 간에 세션을 공유할 필요가 없으며, 서버를 수평적으로 쉽게 확장할 수 있음
- 단기 유효성  
  JWT는 짧은 유효 기간을 가지기 때문에 탈취된 토큰의 유효 기한이 제한되어 보안성을 지킬 수 있음

#### | 프로젝트에 적용할 JWT 토큰 로직

1. 사용자 로그인

- 로그인 요청 수신  
  사용자가 이메일과 비밀번호를 입력하여 로그인 요청 -> LogInFilter에서 처리하도록
- 인증 처리  
  LogInFilter는 입력된 이메일과 비밀번호를 UsernamePasswordAuthenticationToken 객체로 생성하고, AuthenticationManager를 사용하여 인증시도
- 인증 성공  
  인증 성공 시 successfulAuthentication 메서드 호출 -> JWTUtil을 사용하여 두 가지 토큰을 생성 (액세스 토큰, 리프레시 토큰)

2. API 요청

- 요청 수신  
  사용자가 API 요청을 보낼 때, JWTFilter가 요청을 가로챔  
  요청 헤더에서 액세스 토큰을 추출합니다.
- 토큰 검증  
  JWTUtil을 사용하여 액세스 토큰의 유효성 검증 -> 만료된 경우에는 SC_UNAUTHORIZED 상태 코드와 함께 "access token expired" 메시지 반환  
  토큰의 카테고리가 "access"인지 확인 -> 맞지 않으면 "invalid access token" 메시지 반환
- 사용자 인증 처리  
  유효한 액세스 토큰 -> 토큰에서 사용자 정보를 추출  
  추출한 정보로 스프링 시큐리티의 인증 객체 생성 -> 세션 등록 -> 다음 필터로 전달  
  모든 검증이 완료되면 요청을 다음 필터로 전달하여 실제 요청 처리

3. 토큰 재발급 (리프레시)

- 리프레시 요청 수신  
  사용자가 액세스 토큰 만료로 새로운 토큰 요청 -> 이때 쿠키에 저장된 리프레시 토큰 검증 -> 유효성 검증  
  유효성 검사 통과 시 -> 새로운 액세스 토큰, 리프레시 토큰 생성 -> 데이터베이스에 리프레시 토큰 저장

4. 로그아웃

- 로그아웃 요청 수신
  사용자가 로그아웃 요청 -> 리프레시 토큰 검증 및 삭제

더 자세한 구현은 블로그로 확인부탁드리니다!

<br/>

### 🔥 오늘의 도전 과제와 해결 방법

- 스프링부트 프로젝트에 Jwt 토큰 인증 구현

<br/>

### 🗨️ 오늘의 회고

<!--
- 오늘의 학습 경험에 대한 자유로운 생각이나 느낀 점을 기록합니다.
- 성공적인 점, 개선해야 할 점, 새롭게 시도하고 싶은 방법 등을 포함할 수 있습니다.-->

- 인증 방식에 대한 로직 정리 없이 무작적 jwt 인증 방식을 구현하려 하니 많은 오류가 생겼다...
- 로직 정리를 하고 구현을 하니 훨씬 쉽게 구현을 하게 됐다.
